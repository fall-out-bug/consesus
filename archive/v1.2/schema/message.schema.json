{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "consensus://schema/message",
  "title": "Agent Message",
  "description": "Inter-agent communication format (UPC Protocol v2.0)",
  "type": "object",
  "required": ["d", "st", "r", "epic", "sm", "nx"],
  "properties": {
    "d": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "description": "Date in YYYY-MM-DD format"
    },
    "st": {
      "type": "string",
      "enum": ["request", "response", "veto", "approval", "status", "handoff", "planning"],
      "description": "Message status/type"
    },
    "r": {
      "type": "string",
      "enum": ["analyst", "architect", "tech_lead", "developer", "qa", "devops", "sre", "security", "data_ml_quality", "documentation", "prompt_engineer", "support"],
      "description": "Sender role"
    },
    "epic": {
      "type": "string",
      "description": "Epic identifier"
    },
    "sm": {
      "type": "array",
      "items": { "type": "string" },
      "minItems": 1,
      "description": "Summary points (concise)"
    },
    "nx": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Next actions required"
    },
    "artifacts": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Paths to related artifacts"
    },
    "answers": {
      "type": "object",
      "additionalProperties": { "type": "string" },
      "description": "Q&A responses (question_id: answer)"
    },
    "ts": {
      "type": "string",
      "description": "Optional timestamp"
    },
    "status": {
      "type": "string",
      "description": "Optional approval status"
    },
    "verification": {
      "type": "object",
      "description": "Optional verification checklist results"
    }
  },
  "additionalProperties": false
}

