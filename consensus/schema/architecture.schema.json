{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "consensus://schema/architecture",
  "title": "Architecture Artifact",
  "description": "Architect deliverable defining system design (UPC Protocol v2.0)",
  "type": "object",
  "required": ["epic_id", "components", "boundaries"],
  "properties": {
    "epic_id": {
      "type": "string",
      "description": "Epic identifier"
    },
    "components": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name", "layer"],
        "properties": {
          "name": { "type": "string" },
          "layer": {
            "type": "string",
            "enum": ["domain", "application", "infrastructure", "presentation"]
          },
          "ports": {
            "type": "array",
            "items": { "type": "string" }
          },
          "dependencies": {
            "type": "array",
            "items": { "type": "string" }
          },
          "description": { "type": "string" }
        }
      },
      "minItems": 1,
      "description": "System components organized by Clean Architecture layers"
    },
    "boundaries": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["from", "to", "contract"],
        "properties": {
          "from": { "type": "string" },
          "to": { "type": "string" },
          "contract": { "type": "string" },
          "direction": { "type": "string", "enum": ["inward", "outward"] }
        }
      },
      "description": "Layer boundary contracts"
    },
    "contracts": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name", "type"],
        "properties": {
          "name": { "type": "string" },
          "type": { "type": "string", "enum": ["interface", "dto", "event", "command", "query"] },
          "fields": { "type": "array", "items": { "type": "string" } }
        }
      },
      "description": "Interface and DTO contracts"
    },
    "diagrams": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "type": { "type": "string", "enum": ["c4_context", "c4_container", "c4_component", "sequence", "class"] },
          "content": { "type": "string", "description": "Mermaid diagram content" }
        }
      },
      "description": "Architecture diagrams (Mermaid format)"
    },
    "risks": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Identified architectural risks"
    },
    "decisions": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "title", "decision"],
        "properties": {
          "id": { "type": "string" },
          "title": { "type": "string" },
          "decision": { "type": "string" },
          "rationale": { "type": "string" },
          "alternatives": { "type": "array", "items": { "type": "string" } }
        }
      },
      "description": "Key architectural decisions"
    }
  },
  "additionalProperties": false
}

